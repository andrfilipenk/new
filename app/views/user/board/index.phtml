<div class="enterprise-alert enterprise-alert--info" style="display: none ;">
    <div class="enterprise-alert__icon">
        <i class="bi bi-info-circle"></i>
    </div>
    <div class="enterprise-alert__content">
        <div class="enterprise-alert__title">System Maintenance Scheduled</div>
        <div class="enterprise-alert__message">
            The system will undergo scheduled maintenance on October 20, 2025 from 2:00 AM to 4:00 AM UTC.
        </div>
    </div>
</div>


<div class="enterprise-card">
    <div class="enterprise-card__header">
        <h2 class="enterprise-card__title">Tasks assigned to me</h2>
        <div class="enterprise-card__actions">
            <input type="search" class="enterprise-input" placeholder="Filter tasks..." style="width: 200px; height: 32px; font-size: 12px;">
        </div>
    </div>

    <div class="enterprise-card__form">
        <div class="container">
            <?=$this->partial('intern/card-form', ['priorities' => $priorities])?>
        </div>
    </div>

    <div class="enterprise-grid">
        <div class="enterprise-grid__wrapper">
            <table class="enterprise-grid__table">
                <thead class="enterprise-grid__header">
                    <tr>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--checkbox">
                            <input type="checkbox" aria-label="Select all">
                        </th>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--sortable" data-column="id">
                            ID
                            <span class="enterprise-grid__sort-icon">▲</span>
                        </th>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--sortable" data-column="title">
                            Title
                            <span class="enterprise-grid__sort-icon">▲</span>
                        </th>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--sortable" data-column="author">
                            Author
                            <span class="enterprise-grid__sort-icon">▲</span>
                        </th>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--sortable" data-column="status">
                            Status
                            <span class="enterprise-grid__sort-icon">▲</span>
                        </th>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--sortable" data-column="priority">
                            Priority
                            <span class="enterprise-grid__sort-icon">▲</span>
                        </th>
                        <th class="enterprise-grid__header-cell enterprise-grid__header-cell--sortable" data-column="due_date">
                            Due Date
                            <span class="enterprise-grid__sort-icon">▲</span>
                        </th>
                        <th class="enterprise-grid__header-cell">Actions</th>
                    </tr>
                </thead>
                <tbody class="enterprise-grid__body">
                    <?php foreach ($tasks as $task) : ?>
                        <?php $task = new \Intern\Model\Task($task) ?>
                        <tr class="enterprise-grid__row" data-row-id="<?=$task->id?>">
                            <td class="enterprise-grid__cell enterprise-grid__cell--checkbox"><input type="checkbox" aria-label="Select row"></td>
                            <td class="enterprise-grid__cell">#<?=$task->id?></td>
                            <td class="enterprise-grid__cell"><b><?=$task->title?></b></td>
                            <td class="enterprise-grid__cell"><?=$task->creator->name?></td>
                            <td class="enterprise-grid__cell"><span class="enterprise-badge enterprise-badge--<?=$task->status->code?>"><?=$task->status->title?></span></td>
                            <td class="enterprise-grid__cell"><span class="enterprise-badge enterprise-badge--<?=$task->priority->code?>"><?=$task->priority->title?></span></td>
                            <td class="enterprise-grid__cell"><?=$task->dateFormated('end_date')?></td>
                            <td class="enterprise-grid__cell enterprise-grid__cell--actions">
                                <div class="enterprise-grid__cell-actions">
                                    <button class="enterprise-button enterprise-button--ghost enterprise-button--small" title="View">
                                        <i class="bi bi-eye"></i>
                                    </button>
                                    <button class="enterprise-button enterprise-button--ghost enterprise-button--small" title="Edit">
                                        <i class="bi bi-pencil"></i>
                                    </button>
                                </div>
                            </td>
                        </tr>
                    <?php endforeach; ?>
                </tbody>
            </table>
        </div>

        <div class="enterprise-pagination">
            <div class="enterprise-pagination__info">
                 <?=$totalTasks?> entries
            </div>
            <?=$pagination->render()?>
            <div class="enterprise-pagination__controls">
                <button class="enterprise-pagination__button" disabled="">Previous</button>
                <button class="enterprise-pagination__button enterprise-pagination__button--active">1</button>
                <button class="enterprise-pagination__button" disabled="">Next</button>
            </div>
        </div>

        <!--
        <div class="enterprise-pagination">
            <div class="enterprise-pagination__info">
                Showing 1 to 5 of <?=$totalTasks?> entries
            </div>
            <?=$pagination->render()?>
            <div class="enterprise-pagination__controls">
                <button class="enterprise-pagination__button" disabled="">Previous</button>
                <button class="enterprise-pagination__button enterprise-pagination__button--active">1</button>
                <button class="enterprise-pagination__button">2</button>
                <button class="enterprise-pagination__button">3</button>
                <button class="enterprise-pagination__button">...</button>
                <button class="enterprise-pagination__button">50</button>
                <button class="enterprise-pagination__button">Next</button>
            </div>
        </div>
        -->
    </div>
</div>

<div class="enterprise-modal" id="myModal">
    <div class="enterprise-modal__backdrop"></div>
    <div class="enterprise-modal__container">
        <div class="enterprise-modal__header">
            <h2 class="enterprise-modal__title">Modal Title</h2>
            <button class="enterprise-modal__close">×</button>
        </div>
        <div class="enterprise-modal__body">
            Modal content goes here
        </div>
        <div class="enterprise-modal__footer">
            <button class="enterprise-button enterprise-button--secondary">Cancel</button>
            <button class="enterprise-button enterprise-button--primary">Confirm</button>
        </div>
    </div>
</div>


<?php $this->startSection('html-header'); ?>

<?php $this->endSection(); ?>

<?php $this->startSection('html-footer'); ?>
    <script>
        (function() {
            const beginDateInput = document.getElementById('begin_date');
            const endDateInput = document.getElementById('end_date');
            if (beginDateInput && endDateInput) {
                beginDateInput.addEventListener('change', function() {
                    const selectedBeginDate = this.value;
                    if (selectedBeginDate) {
                        endDateInput.min = selectedBeginDate;
                        if (endDateInput.value && endDateInput.value < selectedBeginDate) {
                            endDateInput.value = selectedBeginDate;
                        }
                        endDateInput.focus();
                        endDateInput.showPicker();
                    }
                });
            }
        })();



        let demoModalInstance;
        function openDemoModal() {
            const modal = document.getElementById('myModal');
            if (!demoModalInstance) {
                demoModalInstance = new window.EnterpriseUI.Modal(modal);
            }
            demoModalInstance.open();
        }
        function closeDemoModal() {
            if (demoModalInstance) {
                demoModalInstance.close();
            }
        }
    </script>
<?php $this->endSection(); ?>




<?php $this->startSection('toolbar-right'); ?>
<button class="enterprise-button enterprise-button--secondary">
    <i class="bi bi-download"></i>
    Export
</button>
<button class="enterprise-button enterprise-button--primary"  style="display:none" onclick="openDemoModal()">
    <i class="bi bi-plus-lg"></i>
    Add new Task
</button>
<?php $this->endSection(); ?>



<?php $this->startSection('sidebar-right'); ?>
<aside class="enterprise-sidebar enterprise-sidebar--right">
    <div class="enterprise-card__header">
        <h3 class="enterprise-card__title">Global Activities</h3>
    </div>
    <div class="enterprise-card__body">
        <?php foreach ($activities as $activity): ?>
            <div class="activity-item" style="padding-bottom: 16px; margin-bottom: 16px; border-bottom: 1px solid #ccc">
                <p><?=$activity['content']?></p>
                <div class="activity-item-date">
                    <?=\Core\Utils\Dates::humanReadable(new DateTimeImmutable($activity['created_at']))?>
                </div>
            </div>
        <?php endforeach; ?>
    </div>
</aside>
<?php $this->endSection(); ?>